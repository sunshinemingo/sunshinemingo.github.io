---
layout:     post
title:      "《Recurrent Neural Network Language Models for Open Vocabulary Event-Level Cyber Anomaly Detection》读书笔记"
subtitle:   "Analysis of the real usage and impact of GitHub reactions"
date:       2019-11-04
author:     "Haoyue"
header-img: "img/post-bg-RNN-language.jpg"
tags:
    - 读书
    - 生活
---

## 《Recurrent Neural Network Language Models for Open Vocabulary Event-Level Cyber Anomaly Detection》读书笔记
自动化分析方法是监控和保护网络以保护其承载的敏感或机密数据的关键辅助手段。该工作引入了一种灵活、强大、无监督的方法来检测计算机和网络日志中的异常行为;它在很大程度上消除了现有方法所采用的依赖领域的特征工程。该方法将系统日志作为交织的“句子”(事件日志行)线程来训练在线无监督神经网络语言模型，从而提供了一个正常网络行为的自适应模型。我们比较了标准和双向循环神经网络语言模型在检测网络日志数据中恶意行为的有效性。通过扩展这些模型，我们引入了分层循环架构，它通过对用户随时间推移的操作序列进行建模来提供上下文。对比隔离森林和主成分分析这两种常见的异常检测算法，我们发现在洛斯阿拉莫斯国家实验室的网络安全数据集上有很好的性能。对于日志行级别的red team检测，我们性能最好的基于字符的模型在接收器操作员特征曲线下提供了0.98的测试集区域，这表明该方法在开放词汇表日志源上具有强大的细粒度异常检测性能。


## 一、Background
为了尽量地降低网络安全的风险，必须能够快速检测并减少计算机网络上的恶意活动。在一个典型的场景中，网络防御者和网络管理员的任务是筛选来自各种日志源的大量数据，以评估潜在的安全风险。但是，即使是一个中等规模的网络，其数据量也会迅速增长，从而导致延迟响应。
基于签名的自动检测方法对于识别单个威胁非常有效。尽管该类的精确度很高，但它们的召回率很低，可能无法检测到细微的突变或新型攻击。基于一组未标记的良性活动日志训练集，可以构建一个“正常行为”模型。用于识别异常行为的特征通常是与时间片相关的统计特征向量，但是，这类系统易受现实操作网络的站点特定属性差异的影响。
机器学习在网络异常检测中得到了广泛的研究，从决策树到朴素贝叶斯的机器学习分类器已用于网络安全任务，例如恶意软件检测，网络入侵和内部威胁检测。深度学习方法也被用于专门的网络防御任务。

文中提出的方法旨在最大程度地减少特征工程中隐含的特定于站点的假设，并通过直接在日志行上在线学习语言模型来有效地建模网络使用中的可变变量。语言模型将概率分配给标记序列，系统每天根据前一天的事件动态更新网络语言模型。当语言模型将低概率分配给日志行时，会将其标记为异常。这个方法有以下优点：
1. 简化特征工程。大大减少了部署时间，并且使其与特定网络或日志记录源配置无关。它还消除了数以万计的日志行被提炼成单个聚合的特征向量时所引入的“盲点”，从而使我们的模型能够捕获原本会丢失的模式。
2. 细粒度评估。通过提供更具体和相关的事件，可以缩短分析人员的响应时间。对用户日累计量发出警报的系统需要筛选数万个操作。文中的方法可以为分析人员提供日志行级别甚至标记级别的分数，从而快速找到可疑活动。
3. 实时处理。由于能够实时处理事件，并且内存使用的固定界限不会随时间增长，因此文中的方法适用于日志事件出现在大容量、高速日志流中的常见场景。
这类似于我们的分层方法，在这种方法中，我们使用与最终隐藏状态连接的所有隐藏状态的平均值作为上层RNN的输入。相比之下，文中的模型是完全无监督的，所有组件都是联合训练的。

## 二、Approach
### 1. Log-Line Tokenization

### 2. Recurrent Neural Network Language Models

### 3. Baselines



## 三、Experiment
### 1. Data
洛斯阿拉莫斯国家实验室(LANL)的网络安全数据集由LANL的内部计算机网络连续58天收集的事件日志组成。该数据集包含来自身份验证、进程、网络流和DNS日志源的超过10亿个日志行。标识字段已被匿名化。记录的网络活动包括正常操作的网络活动和数据前30天破坏帐户凭据的一系列red team活动。已知的red team攻击事件信息仅用于评估；我们的方法是完全无监督的。
文中的实验只使用了认证事件日志。我们将这些事件过滤为仅链接到实际用户的日志行，删除了计算机-计算机交互事件。周末和节假日的活动包含截然不同的活动频率和分布。在真实的部署中，会单独训练周末和节假日的模型，但是因为数据中没有恶意事件，它也被保留了。
表3b统计了我们的数据划分;前12天作为开发集，其余18天作为独立测试集。

### 2. Assessment Granularity
我们的模型学习正常行为，并对意外事件分配相对较高的损失。我们方法的主要优势是能够对单个事件的异常进行评分，允许我们在事件级别标记异常或在较大的时间尺度上聚合异常。
对于这项工作，我们考虑两个时间尺度。首先根据单个事件进行评估；事件列表将提供给分析人员，并按异常得分降序排列。其次，为了便于与传统的汇总方法进行比较，实验中汇总了一天中所有用户事件的异常得分(具体而言，取最大值)，从而为每个用户每天产生一个异常得分。在这种情况下，用户每天的列表将提供给分析人员，并按异常分数降序排列。这种方法称为“max”，因为提供给分析人员的异常分数是通过获取该用户窗口中事件分数的最高分数得出的(其中，事件级别得分只是将单人一组的最高分数作为最大值事件)。
为了抵消一天中用户异常得分的系统性偏移，考虑了一种简单的归一化策略，称为diff，首先将每个原始得分减去用户的平均事件级别异常得分，从而对其进行归一化。

### 3. Metrics
实验中考虑了两个性能指标。
首先，我们使用接收器操作特征曲线(AUC)下的标准区域评估结果，该区域表征了模型检测性能在真阳性和假阳性之间的权衡，有效地席卷了所有可能的分析人员预算。假阳性是指检测到的不是真正的red team事件，而真阳性是指检测到的是真正的red team事件。
为了量化分析人员在诊断网络上的恶意行为时必须筛选的数据比例，使用平均百分比(AP)指标。具体而言，对于每个red team事件或用户日，注意到其异常在当天所有异常分数中的百分比。然后，将所有恶意事件或用户天数的这些百分位数取平均值。请注意，如果将所有真正的恶意事件或用户天数标记为相应日期中的异常值最高，则AP≈100；如果将所有恶意事件或用户天数标记为相应日期中的异常值最小，则AP≈0。对于AUC和AP而言，分数越高越好。
实验中对模型的超参数进行了手动调整，以使开发集上的日级差异得分的AP最大化。由于我们的方法无监督和在线训练，因此无需单独的培训集。

### 4. Results and Analysis



## 四、Conclusion



